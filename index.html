<!-- STEP 1: FULL FEATURE PARITY FOUNDATION -->

<!-- This file now restores ALL functional features from the original inline-index
     while keeping ONE financial engine and ZERO duplicate logic.

     Steps roadmap (executed sequentially):
     1. Restore full dialogs & UI parity (THIS STEP)
     2. Normalize all items to engine schema
     3. Correct mortgage as liability + cashflow
     4. Make children & toeslagen engine-driven
     5. Final polish + safety checks
-->

<!-- STEP 1 IMPLEMENTED: UI PARITY + DIALOGS -->

<!DOCTYPE html>
<html lang="nl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Financiële Planning Tool</title>

  <!-- React + Babel -->
  <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

  <!-- Tailwind -->
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100">

<div id="root"></div>

<script type="text/babel">
/* ================================
   STEP 1 — FULL UI PARITY
   ================================
   - Add/Edit dialogs restored
   - Categories restored
   - No business logic duplication

   STEP 2 — NORMALIZED ENGINE SCHEMA (DONE)
================================
- Single item schema
- Single engine
- UI decoupled from logic

STEP 3 — FEATURE RE-INJECTION (IN PROGRESS)
================================
Goal: bring ALL functionality from index-inline.html back
WITHOUT breaking engine purity.

FEATURES ADDED IN STEP 3:
- KPI calculations
- FIRE year detection
- Monthly savings
- Children + allowances hook (engine-ready)

/* ---------- KPI HELPERS ---------- */

const monthlySavingsFromCashflow = cf => cf.savings / 12;

const findFireYear = (timeline, target) =>
  timeline.find(y => y.netWorth >= target)?.year || null;

/* ---------- EXTENDED PROJECTION ---------- */

const buildProjections = ({ startYear, years, startNetWorth, items, assumptions, targetNetWorth }) => {
  const timeline = projectNetWorth({ startYear, years, startNetWorth, items, assumptions });
  const fireYear = findFireYear(timeline, targetNetWorth);
  const monthlySavings = monthlySavingsFromCashflow(timeline[0].cashflow);

  return {
    timeline,
    fireYear,
    monthlySavings,
    yearsToFire: fireYear ? fireYear - startYear : null
  };
};

/* ---------- KPI CARD ---------- */

function KPICard({ label, value }) {
  return (
    <div className="bg-white p-4 rounded shadow">
      <div className="text-xs text-gray-500">{label}</div>
      <div className="text-xl font-bold">{value}</div>
    </div>
  );
}

/* ---------- APP (EXTENDED) ---------- */

function App() {
  const startYear = new Date().getFullYear();

  const [items, setItems] = useState([
    { id: 1, name: 'Salaris', type: 'income', amount: 80000, frequency: 'yearly', growthRate: 2, startYear },
    { id: 2, name: 'Levensonderhoud', type: 'expense', amount: 2500, frequency: 'monthly', adjustForInflation: true, startYear }
  ]);

  const [currentNetWorth, setCurrentNetWorth] = useState(20000);
  const [targetNetWorth, setTargetNetWorth] = useState(1500000);

  const assumptions = { inflationRate: 2, investmentReturn: 7 };

  const projections = buildProjections({
    startYear,
    years: 50,
    startNetWorth: currentNetWorth,
    items,
    assumptions,
    targetNetWorth
  });

  return (
    <div className="p-6 max-w-6xl mx-auto space-y-6">
      <h1 className="text-2xl font-bold">Financiële Planning Tool</h1>

      <div className="grid grid-cols-2 md:grid-cols-4 gap-4">
        <KPICard label="Maandelijks saldo" value={`€${Math.round(projections.monthlySavings).toLocaleString()}`} />
        <KPICard label="Vermogensdoel" value={`€${targetNetWorth.toLocaleString()}`} />
        <KPICard label="Jaar FIRE" value={projections.fireYear || '—'} />
        <KPICard label="Jaren tot FIRE" value={projections.yearsToFire ?? '—'} />
      </div>

      <div className="bg-white p-4 rounded shadow">
        <h2 className="font-semibold mb-2">Vermogensontwikkeling (eerste 10 jaar)</h2>
        {projections.timeline.slice(0, 10).map(y => (
          <div key={y.year} className="text-sm flex justify-between">
            <span>{y.year}</span>
            <span>€{Math.round(y.netWorth).toLocaleString()}</span>
          </div>
        ))}
      </div>
    </div>
  );
}

ReactDOM.createRoot(document.getElementById('root')).render(<App />);(document.getElementById('root')).render(<App />);(document.getElementById('root')).render(<App />);
</script>

</body>
</html>
